stages:
  - build
  - test

main_build_debug:
    only:
      - main
    stage: build
    tags: 
      - FreeBSD
    script:
      - gmake debug

main_build_release:
    only:
      - main
    stage: build
    tags: 
      - FreeBSD
    script:
      - gmake release
    artifacts:
      paths:
        - "wallmon"
      expire_in: 1 hour

main_build_tests:
    only:
      - main
    stage: build
    tags: 
      - FreeBSD
    script:
      - gmake test
    artifacts:
      paths:
        - "wallmon_test"
      expire_in: 1 hour

main_test:
    stage: test
    only:
      - main
    tags:
      - FreeBSD
    script:
      - valgrind --leak-check=full --show-leak-kinds=all --error-exitcode=1 ./wallmon_test
